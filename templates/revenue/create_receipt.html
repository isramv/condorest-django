{% extends 'base.html' %}
{% load static humanize bootstrap4 %}

{% block content %}
<h1>{{ lot.name }} <small>{{ lot.address }}</small></h1>

<div class="row">

    <div class="col-md-8">
    <form method="post">
        <h4>Pending fees</h4>
        <!-- fees -->
        <table id="fees" class="table table-striped table-bordered table-hover table-sm">
        <thead>
            <tr>
                <th>Date</th>
                <th>Fee</th>
                <th>D.</th>
                <th>Payment</th>
                <th>Balance</th>
            </tr>
        </thead>
        <tbody>
        {% for fee in fees %}
            <tr class="fee-row">
                <td><samp class="fee-date">{{ fee.date|date:"b Y" }}</samp></td>
                <td class="text-right"><samp class="fee-amount">{{ fee.amount|intcomma }}</samp></td>
                <td class="text-right"><samp class="fee-discount"></samp></td>
                <td class="text-right"><samp class="fee-payment"></samp></td>
                <td class="text-right"><samp class="fee-balance">{{ fee.balance|intcomma }}</samp></td>
            </tr>
        {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <th><samp>Total</samp></th>
                <th class="text-right"><samp class="fee-amount-total">{{ balance|intcomma }}</samp></th>
                <th class="text-right"><samp class="fee-discount-total"></samp></th>
                <th class=""><samp class="fee-payment-total"><input class="text-right" title="amount" style="width: 110px"></samp></th>
                <th class="text-right"><samp class="fee-balance-total">{{ balance|intcomma }}</samp></th>
            </tr>
            <tr class="discount-row">
                <th colspan="2"><samp>Discount</samp></th>
                <th colspan="3" class="text-center">
                    <samp class="fee-discount"><input class="text-right" title="discount" style="width: 110px"></samp>
                    or
                    <samp class="fee-discount-rate"><input class="text-right" title="discount-rate" style="width: 50px">%</samp>
                </th>
            </tr>
        </tfoot>
        </table>

        {% bootstrap_form_errors form %}
        {% csrf_token %}
        <div class="form-group row">
            {% bootstrap_field form.date form_group_class="col" %}
            {% bootstrap_field form.number form_group_class="col" %}
            {% bootstrap_field form.contact form_group_class="col" %}
        </div>
        <div class="form-group row">
            {% bootstrap_field form.debit_account form_group_class="col" %}
            {% bootstrap_field form.credit_account form_group_class="col" %}
        </div>
        {% bootstrap_field form.details %}
        {% bootstrap_field form.save_in_ledger %}

        {% buttons %}
            <button type="submit" class="btn btn-primary">Submit</button>
        {% endbuttons %}
    </form>
    </div>

    <div class="col-md-4">
        <h4>Receipt history</h4>
        <!-- receips -->
        {% for receipt in receipts %}
        <div class="row">
            <div class="col">{{ receipt.date|date:"Y-m-d" }}</div>
            <div class="col text-right"><strong>{{ receipt.amount|intcomma }}</strong></div>
        </div>
        <div>{{ receipt.details|linebreaks }}</div>
        {% endfor %}
    </div>
</div>
{% endblock %}

{% block javascript %}
    <script src="{% static 'js/create_receipt.js' %}"></script>
{% endblock %}
